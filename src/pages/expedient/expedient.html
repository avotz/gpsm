<ion-header>
    <ion-navbar no-border-bottom>
        <ion-title>
            Mi Expediente
        </ion-title>
    </ion-navbar>

</ion-header>


<ion-content>
    <ion-segment [(ngModel)]="personal_control">
        <ion-segment-button value="pressure">
            Presión
        </ion-segment-button>
        <ion-segment-button value="sugar">
            Azúcar
        </ion-segment-button>
        <ion-segment-button value="medicines">
            Medicamentos
        </ion-segment-button>
        <ion-segment-button value="alergies">
            Alergias
        </ion-segment-button>
    </ion-segment>
    <div [ngSwitch]="personal_control">
        <div *ngSwitchCase="'pressure'">
            <form [formGroup]="pressureForm">
                <ion-grid>
                    <ion-row>
                        <ion-col col-6>
                            <ion-item>
                                <ion-label floating>Fecha de Control</ion-label>
                                <ion-datetime displayFormat="MMM DD, YYYY" formControlName="date_control" [class.invalid]="!pressureForm.controls.date_control.valid && (pressureForm.controls.date_control.dirty || submitAttempt)"></ion-datetime>

                            </ion-item>

                            <p *ngIf="!pressureForm.controls.date_control.valid  && (pressureForm.controls.date_control.dirty || submitAttempt)" class="error">Ingrese una fecha válida.</p>

                        </ion-col>
                        <ion-col col-6>
                            <ion-item>
                                <ion-label floating>Hora de Control</ion-label>
                                <ion-datetime displayFormat="h:mm A" pickerFormat="h mm A" formControlName="time_control"></ion-datetime>
                            </ion-item>

                            <p *ngIf="!pressureForm.controls.time_control.valid  && (pressureForm.controls.time_control.dirty || submitAttempt)" class="error">Ingrese una hora válida.</p>

                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col col-6>
                            <ion-item>
                                <ion-label floating>P.D</ion-label>
                                <ion-input formControlName="pd" type="text" [class.invalid]="!pressureForm.controls.pd.valid && (pressureForm.controls.pd.dirty || submitAttempt)"></ion-input>

                            </ion-item>

                            <p *ngIf="!pressureForm.controls.pd.valid  && (pressureForm.controls.pd.dirty || submitAttempt)" class="error">Ingrese un P.D válido.</p>

                        </ion-col>
                        <ion-col col-6>
                            <ion-item>
                                <ion-label floating>P.S</ion-label>
                                <ion-input formControlName="ps" type="text" [class.invalid]="!pressureForm.controls.ps.valid && (pressureForm.controls.ps.dirty || submitAttempt)"></ion-input>

                            </ion-item>

                            <p *ngIf="!pressureForm.controls.ps.valid  && (pressureForm.controls.ps.dirty || submitAttempt)" class="error">Ingrese un P.S válido.</p>

                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col class="signup-col">
                            <button ion-button class="submit-btn" full (click)="savePressure()">Guardar</button>

                        </ion-col>
                    </ion-row>

                </ion-grid>




            </form>
            <ion-list>

                <ion-item *ngFor="let item of pressures">


                    <h2><b>P.S:</b> {{ item.ps }} / <b>P.D:</b> {{ item.pd }} - <small> {{ item.date_control }} {{ item.time_control
                        }}</small>
                    </h2>

                    <button ion-button clear item-end (click)="deletePressure(item)" color="danger"><ion-icon name="trash"></ion-icon></button>
                </ion-item>


            </ion-list>
        </div>
        <div *ngSwitchCase="'sugar'">
                <form [formGroup]="sugarForm">
                        <ion-grid>
                            <ion-row>
                                <ion-col col-6>
                                    <ion-item>
                                        <ion-label floating>Fecha de Control</ion-label>
                                        <ion-datetime displayFormat="MMM DD, YYYY" formControlName="date_control" [class.invalid]="!sugarForm.controls.date_control.valid && (sugarForm.controls.date_control.dirty || submitAttempt)"></ion-datetime>
        
                                    </ion-item>
        
                                    <p *ngIf="!sugarForm.controls.date_control.valid  && (sugarForm.controls.date_control.dirty || submitAttempt)" class="error">Ingrese una fecha válida.</p>
        
                                </ion-col>
                                <ion-col col-6>
                                    <ion-item>
                                        <ion-label floating>Hora de Control</ion-label>
                                        <ion-datetime displayFormat="h:mm A" pickerFormat="h mm A" formControlName="time_control"></ion-datetime>
                                    </ion-item>
        
                                    <p *ngIf="!sugarForm.controls.time_control.valid  && (sugarForm.controls.time_control.dirty || submitAttempt)" class="error">Ingrese una hora válida.</p>
        
                                </ion-col>
                            </ion-row>
                            <ion-row>
                                <ion-col col-12>
                                    <ion-item>
                                        <ion-label floating>Glicemia</ion-label>
                                        <ion-input formControlName="glicemia" type="text" [class.invalid]="!sugarForm.controls.glicemia.valid && (sugarForm.controls.glicemia.dirty || submitAttempt)"></ion-input>
        
                                    </ion-item>
        
                                    <p *ngIf="!sugarForm.controls.glicemia.valid  && (sugarForm.controls.glicemia.dirty || submitAttempt)" class="error">Ingrese una glicemia válida.</p>
        
                                </ion-col>
                               
                            </ion-row>
                            <ion-row>
                                <ion-col class="signup-col">
                                    <button ion-button class="submit-btn" full (click)="saveSugar()">Guardar</button>
        
                                </ion-col>
                            </ion-row>
        
                        </ion-grid>
        
        
        
        
                    </form>
                    <ion-list>
        
                        <ion-item *ngFor="let item of sugars">
        
        
                            <h2><b>Glicemia:</b> {{ item.glicemia }} {{ item.pd }} - <small>{{ item.date_control }} {{ item.time_control
                                }}</small>
                            </h2>
        
                            <button ion-button clear item-end (click)="deleteSugar(item)" color="danger"><ion-icon name="trash"></ion-icon></button>
                        </ion-item>
        
        
                    </ion-list>
        </div>
        <div *ngSwitchCase="'medicines'">
                <form [formGroup]="medicineForm">
                        <ion-grid>
                            
                            <ion-row>
                                <ion-col col-12>
                                    <ion-item>
                                        <ion-label floating>Medicamento activo</ion-label>
                                        <ion-input formControlName="name" type="text" [class.invalid]="!medicineForm.controls.name.valid && (medicineForm.controls.name.dirty || submitAttempt)"></ion-input>
        
                                    </ion-item>
        
                                    <p *ngIf="!medicineForm.controls.name.valid  && (medicineForm.controls.name.dirty || submitAttempt)" class="error">Ingrese un medicamento válida.</p>
        
                                </ion-col>
                               
                            </ion-row>
                            <ion-row>
                                <ion-col class="signup-col">
                                    <button ion-button class="submit-btn" full (click)="saveMedicine()">Guardar</button>
        
                                </ion-col>
                            </ion-row>
        
                        </ion-grid>
        
        
        
        
                    </form>
                    <ion-list>
        
                        <ion-item *ngFor="let item of medicines">
        
        
                            <h2> {{ item.name }} 
                               
                            </h2>
        
                            <button ion-button clear item-end (click)="deleteMedicine(item)" color="danger"><ion-icon name="trash"></ion-icon></button>
                        </ion-item>
        
        
                    </ion-list>
        </div>
        <div *ngSwitchCase="'alergies'">
                <form [formGroup]="allergyForm">
                        <ion-grid>
                            
                            <ion-row>
                                <ion-col col-12>
                                    <ion-item>
                                        <ion-label floating>Alergia</ion-label>
                                        <ion-input formControlName="name" type="text" [class.invalid]="!allergyForm.controls.name.valid && (allergyForm.controls.name.dirty || submitAttempt)"></ion-input>
        
                                    </ion-item>
        
                                    <p *ngIf="!allergyForm.controls.name.valid  && (allergyForm.controls.name.dirty || submitAttempt)" class="error">Ingrese una alergia válida.</p>
        
                                </ion-col>
                               
                            </ion-row>
                            <ion-row>
                                <ion-col class="signup-col">
                                    <button ion-button class="submit-btn" full (click)="saveAllergy()">Guardar</button>
        
                                </ion-col>
                            </ion-row>
        
                        </ion-grid>
        
        
        
        
                    </form>
                    <ion-list>
        
                        <ion-item *ngFor="let item of allergies">
        
        
                            <h2> {{ item.name }} 
                               
                            </h2>
        
                            <button ion-button clear item-end (click)="deleteAllergy(item)" color="danger" *ngIf="item.user.roles[0].name == 'paciente'"><ion-icon name="trash"></ion-icon></button>
                        </ion-item>
        
        
                    </ion-list>
        </div>


    </div>
</ion-content>